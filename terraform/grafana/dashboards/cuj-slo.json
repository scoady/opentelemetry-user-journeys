{
  "__inputs": [
    {
      "name": "DS_PROMETHEUS",
      "label": "Prometheus (Mimir)",
      "description": "Grafana Cloud Prometheus / Mimir",
      "type": "datasource",
      "pluginId": "prometheus",
      "pluginName": "Prometheus"
    }
  ],
  "__requires": [
    { "type": "grafana",    "id": "grafana",    "name": "Grafana",     "version": "10.0.0" },
    { "type": "datasource", "id": "prometheus", "name": "Prometheus",  "version": "1.0.0"  },
    { "type": "panel",      "id": "stat",       "name": "Stat",        "version": ""       },
    { "type": "panel",      "id": "gauge",      "name": "Gauge",       "version": ""       },
    { "type": "panel",      "id": "timeseries", "name": "Time series", "version": ""       }
  ],
  "title": "TechMart — CUJ SLO Dashboard",
  "description": "Burn rates, error budgets, and SLO health for all Critical User Journeys. Burn rate = (actual error rate) / (budget error rate). Fast burn >14.4x exhausts the monthly budget in ~2 days.",
  "uid": "techmart-cuj-slo",
  "version": 3,
  "schemaVersion": 38,
  "tags": ["slo", "techmart", "cuj", "burn-rate", "error-budget"],
  "time": { "from": "now-24h", "to": "now" },
  "refresh": "30s",
  "templating": {
    "list": [
      {
        "name": "datasource",
        "type": "datasource",
        "pluginId": "prometheus",
        "label": "Datasource",
        "hide": 0,
        "current": {}
      },
      {
        "name": "window",
        "type": "custom",
        "label": "SLO window",
        "query": "1h,6h,24h,7d,30d",
        "options": [
          { "text": "1h",  "value": "1h",  "selected": false },
          { "text": "6h",  "value": "6h",  "selected": false },
          { "text": "24h", "value": "24h", "selected": true  },
          { "text": "7d",  "value": "7d",  "selected": false },
          { "text": "30d", "value": "30d", "selected": false }
        ],
        "current": { "text": "24h", "value": "24h" },
        "hide": 0
      }
    ]
  },

  "panels": [

    { "type": "row", "title": "Burn Rate — 1h window", "id": 100,
      "collapsed": false, "gridPos": { "x": 0, "y": 0, "w": 24, "h": 1 } },

    {
      "type": "stat", "id": 1,
      "title": "checkout — 1h",
      "description": "Error budget burn rate over 1h. 1x = on budget. >6x = slow burn (ticket). >14.4x = fast burn (page).",
      "gridPos": { "x": 0, "y": 1, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.checkout\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.checkout\"}[1h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 2,
      "title": "product-discovery — 1h",
      "gridPos": { "x": 4, "y": 1, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\"}[1h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 3,
      "title": "order-lookup — 1h",
      "gridPos": { "x": 8, "y": 1, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\"}[1h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 30,
      "title": "product-search — 1h",
      "gridPos": { "x": 12, "y": 1, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-search\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-search\"}[1h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 40,
      "title": "product-review — 1h",
      "gridPos": { "x": 16, "y": 1, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-review\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-review\"}[1h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },

    { "type": "row", "title": "Burn Rate — 6h window", "id": 101,
      "collapsed": false, "gridPos": { "x": 0, "y": 5, "w": 24, "h": 1 } },

    {
      "type": "stat", "id": 4,
      "title": "checkout — 6h",
      "gridPos": { "x": 0, "y": 6, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.checkout\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.checkout\"}[6h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 5,
      "title": "product-discovery — 6h",
      "gridPos": { "x": 4, "y": 6, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\"}[6h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 6,
      "title": "order-lookup — 6h",
      "gridPos": { "x": 8, "y": 6, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\"}[6h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 31,
      "title": "product-search — 6h",
      "gridPos": { "x": 12, "y": 6, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-search\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-search\"}[6h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },
    {
      "type": "stat", "id": 41,
      "title": "product-review — 6h",
      "gridPos": { "x": 16, "y": 6, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-review\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-review\"}[6h])) / 0.001", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "none" },
      "fieldConfig": { "defaults": { "unit": "short", "decimals": 2, "min": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1 }, { "color": "orange", "value": 6 }, { "color": "red", "value": 14.4 }] } } }
    },

    { "type": "row", "title": "Success Rate", "id": 102,
      "collapsed": false, "gridPos": { "x": 0, "y": 10, "w": 24, "h": 1 } },

    {
      "type": "stat", "id": 7, "title": "checkout",
      "description": "% of cuj.checkout spans that succeeded. SLO: 99.9%.",
      "gridPos": { "x": 0, "y": 11, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * sum(increase(techmart_calls_total{span_name=\"cuj.checkout\", status_code!=\"STATUS_CODE_ERROR\"}[$window])) / sum(increase(techmart_calls_total{span_name=\"cuj.checkout\"}[$window]))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 3, "min": 99, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 99.5 }, { "color": "green", "value": 99.9 }] } } }
    },
    {
      "type": "stat", "id": 8, "title": "product-discovery",
      "gridPos": { "x": 4, "y": 11, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * sum(increase(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code!=\"STATUS_CODE_ERROR\"}[$window])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-discovery\"}[$window]))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 3, "min": 99, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 99.5 }, { "color": "green", "value": 99.9 }] } } }
    },
    {
      "type": "stat", "id": 9, "title": "order-lookup",
      "gridPos": { "x": 8, "y": 11, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * sum(increase(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code!=\"STATUS_CODE_ERROR\"}[$window])) / sum(increase(techmart_calls_total{span_name=\"cuj.order-lookup\"}[$window]))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 3, "min": 99, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 99.5 }, { "color": "green", "value": 99.9 }] } } }
    },
    {
      "type": "stat", "id": 32, "title": "product-search",
      "gridPos": { "x": 12, "y": 11, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * sum(increase(techmart_calls_total{span_name=\"cuj.product-search\", status_code!=\"STATUS_CODE_ERROR\"}[$window])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-search\"}[$window]))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 3, "min": 99, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 99.5 }, { "color": "green", "value": 99.9 }] } } }
    },
    {
      "type": "stat", "id": 42, "title": "product-review",
      "gridPos": { "x": 16, "y": 11, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * sum(increase(techmart_calls_total{span_name=\"cuj.product-review\", status_code!=\"STATUS_CODE_ERROR\"}[$window])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-review\"}[$window]))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 3, "min": 99, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 99.5 }, { "color": "green", "value": 99.9 }] } } }
    },

    { "type": "row", "title": "Error Budget Remaining (30d)", "id": 103,
      "collapsed": false, "gridPos": { "x": 0, "y": 15, "w": 24, "h": 1 } },

    {
      "type": "gauge", "id": 10, "title": "checkout",
      "description": "Error budget remaining for checkout. Budget = 0.1% of spans allowed to fail over 30 days.",
      "gridPos": { "x": 0, "y": 16, "w": 4, "h": 6 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * (1 - (sum(increase(techmart_calls_total{span_name=\"cuj.checkout\", status_code=\"STATUS_CODE_ERROR\"}[30d])) / sum(increase(techmart_calls_total{span_name=\"cuj.checkout\"}[30d]))) / 0.001)", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "showThresholdLabels": false, "showThresholdMarkers": true, "minVizHeight": 75 },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 1, "min": 0, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 25 }, { "color": "green", "value": 50 }] } } }
    },
    {
      "type": "gauge", "id": 11, "title": "product-discovery",
      "gridPos": { "x": 4, "y": 16, "w": 4, "h": 6 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * (1 - (sum(increase(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code=\"STATUS_CODE_ERROR\"}[30d])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-discovery\"}[30d]))) / 0.001)", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "showThresholdLabels": false, "showThresholdMarkers": true, "minVizHeight": 75 },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 1, "min": 0, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 25 }, { "color": "green", "value": 50 }] } } }
    },
    {
      "type": "gauge", "id": 12, "title": "order-lookup",
      "gridPos": { "x": 8, "y": 16, "w": 4, "h": 6 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * (1 - (sum(increase(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code=\"STATUS_CODE_ERROR\"}[30d])) / sum(increase(techmart_calls_total{span_name=\"cuj.order-lookup\"}[30d]))) / 0.001)", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "showThresholdLabels": false, "showThresholdMarkers": true, "minVizHeight": 75 },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 1, "min": 0, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 25 }, { "color": "green", "value": 50 }] } } }
    },
    {
      "type": "gauge", "id": 33, "title": "product-search",
      "gridPos": { "x": 12, "y": 16, "w": 4, "h": 6 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * (1 - (sum(increase(techmart_calls_total{span_name=\"cuj.product-search\", status_code=\"STATUS_CODE_ERROR\"}[30d])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-search\"}[30d]))) / 0.001)", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "showThresholdLabels": false, "showThresholdMarkers": true, "minVizHeight": 75 },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 1, "min": 0, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 25 }, { "color": "green", "value": 50 }] } } }
    },
    {
      "type": "gauge", "id": 43, "title": "product-review",
      "gridPos": { "x": 16, "y": 16, "w": 4, "h": 6 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "100 * (1 - (sum(increase(techmart_calls_total{span_name=\"cuj.product-review\", status_code=\"STATUS_CODE_ERROR\"}[30d])) / sum(increase(techmart_calls_total{span_name=\"cuj.product-review\"}[30d]))) / 0.001)", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "showThresholdLabels": false, "showThresholdMarkers": true, "minVizHeight": 75 },
      "fieldConfig": { "defaults": { "unit": "percent", "decimals": 1, "min": 0, "max": 100, "thresholds": { "mode": "absolute", "steps": [{ "color": "red", "value": null }, { "color": "yellow", "value": 25 }, { "color": "green", "value": 50 }] } } }
    },

    { "type": "row", "title": "p99 Latency", "id": 104,
      "collapsed": false, "gridPos": { "x": 0, "y": 22, "w": 24, "h": 1 } },

    {
      "type": "stat", "id": 13, "title": "checkout (SLO < 2s)",
      "gridPos": { "x": 0, "y": 23, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.checkout\"}[5m])) by (le))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "ms", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 1000 }, { "color": "red", "value": 2000 }] } } }
    },
    {
      "type": "stat", "id": 14, "title": "product-discovery (SLO < 1s)",
      "gridPos": { "x": 4, "y": 23, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-discovery\"}[5m])) by (le))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "ms", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 500 }, { "color": "red", "value": 1000 }] } } }
    },
    {
      "type": "stat", "id": 15, "title": "order-lookup (SLO < 1s)",
      "gridPos": { "x": 8, "y": 23, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.order-lookup\"}[5m])) by (le))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "ms", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 500 }, { "color": "red", "value": 1000 }] } } }
    },
    {
      "type": "stat", "id": 34, "title": "product-search (SLO < 500ms)",
      "gridPos": { "x": 12, "y": 23, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-search\"}[5m])) by (le))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "ms", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 250 }, { "color": "red", "value": 500 }] } } }
    },
    {
      "type": "stat", "id": 44, "title": "product-review (SLO < 1s)",
      "gridPos": { "x": 16, "y": 23, "w": 4, "h": 4 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [{ "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-review\"}[5m])) by (le))", "legendFormat": "" }],
      "options": { "reduceOptions": { "calcs": ["lastNotNull"] }, "colorMode": "background", "graphMode": "area" },
      "fieldConfig": { "defaults": { "unit": "ms", "decimals": 0, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 500 }, { "color": "red", "value": 1000 }] } } }
    },

    {
      "type": "timeseries", "id": 20,
      "title": "Success Rate — all CUJs",
      "description": "Instantaneous success rate per CUJ (5m rate window). The dashed red line is the 99.9% SLO target.",
      "gridPos": { "x": 0, "y": 27, "w": 24, "h": 8 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [
        { "expr": "100 * sum(rate(techmart_calls_total{span_name=\"cuj.checkout\", status_code!=\"STATUS_CODE_ERROR\"}[5m])) / sum(rate(techmart_calls_total{span_name=\"cuj.checkout\"}[5m]))", "legendFormat": "checkout" },
        { "expr": "100 * sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code!=\"STATUS_CODE_ERROR\"}[5m])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\"}[5m]))", "legendFormat": "product-discovery" },
        { "expr": "100 * sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code!=\"STATUS_CODE_ERROR\"}[5m])) / sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\"}[5m]))", "legendFormat": "order-lookup" },
        { "expr": "100 * sum(rate(techmart_calls_total{span_name=\"cuj.product-search\", status_code!=\"STATUS_CODE_ERROR\"}[5m])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-search\"}[5m]))", "legendFormat": "product-search" },
        { "expr": "100 * sum(rate(techmart_calls_total{span_name=\"cuj.product-review\", status_code!=\"STATUS_CODE_ERROR\"}[5m])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-review\"}[5m]))", "legendFormat": "product-review" },
        { "expr": "vector(99.9)", "legendFormat": "SLO target (99.9%)" }
      ],
      "fieldConfig": {
        "defaults": { "unit": "percent", "min": 98, "max": 100.5, "custom": { "lineWidth": 2, "fillOpacity": 5 } },
        "overrides": [
          { "matcher": { "id": "byName", "options": "checkout" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } }] },
          { "matcher": { "id": "byName", "options": "product-discovery" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }] },
          { "matcher": { "id": "byName", "options": "order-lookup" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "purple" } }] },
          { "matcher": { "id": "byName", "options": "product-search" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "yellow" } }] },
          { "matcher": { "id": "byName", "options": "product-review" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }] },
          { "matcher": { "id": "byName", "options": "SLO target (99.9%)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] }
        ]
      },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } }
    },

    {
      "type": "timeseries", "id": 21,
      "title": "Burn Rate — 1h window",
      "description": "Error budget burn rate over a 1h window per CUJ. Dashed orange = 6x (slow-burn alert). Dashed red = 14.4x (fast-burn / page).",
      "gridPos": { "x": 0, "y": 35, "w": 12, "h": 8 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.checkout\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.checkout\"}[1h])) / 0.001", "legendFormat": "checkout" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\"}[1h])) / 0.001", "legendFormat": "product-discovery" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\"}[1h])) / 0.001", "legendFormat": "order-lookup" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-search\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-search\"}[1h])) / 0.001", "legendFormat": "product-search" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-review\", status_code=\"STATUS_CODE_ERROR\"}[1h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-review\"}[1h])) / 0.001", "legendFormat": "product-review" },
        { "expr": "vector(14.4)", "legendFormat": "fast burn (14.4x)" },
        { "expr": "vector(6)", "legendFormat": "slow burn (6x)" }
      ],
      "fieldConfig": {
        "defaults": { "unit": "short", "decimals": 2, "min": 0, "custom": { "lineWidth": 2, "fillOpacity": 5 } },
        "overrides": [
          { "matcher": { "id": "byName", "options": "checkout" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } }] },
          { "matcher": { "id": "byName", "options": "product-discovery" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }] },
          { "matcher": { "id": "byName", "options": "order-lookup" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "purple" } }] },
          { "matcher": { "id": "byName", "options": "product-search" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "yellow" } }] },
          { "matcher": { "id": "byName", "options": "product-review" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }] },
          { "matcher": { "id": "byName", "options": "fast burn (14.4x)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] },
          { "matcher": { "id": "byName", "options": "slow burn (6x)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] }
        ]
      },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } }
    },

    {
      "type": "timeseries", "id": 22,
      "title": "Burn Rate — 6h window",
      "description": "Error budget burn rate over a 6h window per CUJ. A slower window reduces noise.",
      "gridPos": { "x": 12, "y": 35, "w": 12, "h": 8 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.checkout\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.checkout\"}[6h])) / 0.001", "legendFormat": "checkout" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-discovery\"}[6h])) / 0.001", "legendFormat": "product-discovery" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.order-lookup\"}[6h])) / 0.001", "legendFormat": "order-lookup" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-search\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-search\"}[6h])) / 0.001", "legendFormat": "product-search" },
        { "expr": "sum(rate(techmart_calls_total{span_name=\"cuj.product-review\", status_code=\"STATUS_CODE_ERROR\"}[6h])) / sum(rate(techmart_calls_total{span_name=\"cuj.product-review\"}[6h])) / 0.001", "legendFormat": "product-review" },
        { "expr": "vector(14.4)", "legendFormat": "fast burn (14.4x)" },
        { "expr": "vector(6)", "legendFormat": "slow burn (6x)" }
      ],
      "fieldConfig": {
        "defaults": { "unit": "short", "decimals": 2, "min": 0, "custom": { "lineWidth": 2, "fillOpacity": 5 } },
        "overrides": [
          { "matcher": { "id": "byName", "options": "checkout" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } }] },
          { "matcher": { "id": "byName", "options": "product-discovery" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }] },
          { "matcher": { "id": "byName", "options": "order-lookup" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "purple" } }] },
          { "matcher": { "id": "byName", "options": "product-search" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "yellow" } }] },
          { "matcher": { "id": "byName", "options": "product-review" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }] },
          { "matcher": { "id": "byName", "options": "fast burn (14.4x)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] },
          { "matcher": { "id": "byName", "options": "slow burn (6x)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] }
        ]
      },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } }
    },

    {
      "type": "timeseries", "id": 23,
      "title": "p99 Latency — all CUJs",
      "description": "99th-percentile request latency per CUJ over a 5m rate window.",
      "gridPos": { "x": 0, "y": 43, "w": 24, "h": 8 },
      "datasource": { "type": "prometheus", "uid": "${datasource}" },
      "targets": [
        { "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.checkout\"}[5m])) by (le))", "legendFormat": "checkout" },
        { "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-discovery\"}[5m])) by (le))", "legendFormat": "product-discovery" },
        { "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.order-lookup\"}[5m])) by (le))", "legendFormat": "order-lookup" },
        { "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-search\"}[5m])) by (le))", "legendFormat": "product-search" },
        { "expr": "histogram_quantile(0.99, sum(rate(techmart_duration_milliseconds_bucket{span_name=\"cuj.product-review\"}[5m])) by (le))", "legendFormat": "product-review" },
        { "expr": "vector(2000)", "legendFormat": "checkout SLO (2 s)" },
        { "expr": "vector(1000)", "legendFormat": "browse / lookup / review SLO (1 s)" },
        { "expr": "vector(500)", "legendFormat": "search SLO (500 ms)" }
      ],
      "fieldConfig": {
        "defaults": { "unit": "ms", "custom": { "lineWidth": 2, "fillOpacity": 5 } },
        "overrides": [
          { "matcher": { "id": "byName", "options": "checkout" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "blue" } }] },
          { "matcher": { "id": "byName", "options": "product-discovery" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }] },
          { "matcher": { "id": "byName", "options": "order-lookup" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "purple" } }] },
          { "matcher": { "id": "byName", "options": "product-search" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "yellow" } }] },
          { "matcher": { "id": "byName", "options": "product-review" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }] },
          { "matcher": { "id": "byName", "options": "checkout SLO (2 s)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] },
          { "matcher": { "id": "byName", "options": "browse / lookup / review SLO (1 s)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "orange" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] },
          { "matcher": { "id": "byName", "options": "search SLO (500 ms)" }, "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "dark-yellow" } }, { "id": "custom.lineStyle", "value": { "fill": "dash" } }, { "id": "custom.fillOpacity", "value": 0 }, { "id": "custom.lineWidth", "value": 1 }] }
        ]
      },
      "options": { "tooltip": { "mode": "multi" }, "legend": { "displayMode": "list", "placement": "bottom" } }
    }

  ]
}
